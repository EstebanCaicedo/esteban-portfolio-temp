<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Esteban Caicedo – Engineering Portfolio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/svg+xml" href="assets/favicon.svg" />
</head>
<body>
  <!-- ================= NAVBAR ================= -->
  <header class="site-header">
    <div class="nav-inner">
      <a href="index.html" class="nav-logo">
        <span class="nav-dot"></span>
        <span>Esteban <span class="nav-last">Caicedo</span></span>
      </a>

      <nav class="nav-links">
        <a href="#projects" class="nav-link">Projects</a>
        <span class="nav-link nav-link--muted">Experience</span>
        <a href="https://www.linkedin.com" target="_blank" class="nav-cta">
          LinkedIn
        </a>
      </nav>
    </div>
  </header>

  <main>
    <!-- ================= HERO ================= -->
    <section class="hero">
      <div class="hero-grid">
        <!-- Panel izquierdo (slot para viewer futuro) -->
        <div class="hero-preview">
          <!-- Teaser 3D / imagen futura -->
        </div>

        <!-- Texto y CTA -->
        <div>
          <p class="hero-kicker">
            CAD/CAE · Manufacturing · Composites · 3D Web
          </p>
          <h1 class="hero-title">
            Engineering Projects,<br />
            ready for real-time.
          </h1>
          <p class="hero-subtitle">
            Clean models, CAM-ready parts, and interactive 3D viewers you can
            drop straight into digital pipelines.
          </p>

          <div class="hero-buttons">
            <a href="#projects" class="hero-btn primary">View Projects</a>
            <a href="Esteban_Caicedo_Resume.pdf" class="hero-btn secondary">
              Download Resume
            </a>
          </div>

          <div class="hero-tags-row">
            <span class="hero-tag">ARIES</span>
            <span class="hero-tag">WIMTACH</span>
            <span class="hero-tag">C-Bond</span>
          </div>
        </div>
      </div>

      <!-- Filtros visuales -->
      <div class="filter-row">
        <button class="filter-pill filter-pill--active" data-filter="all">All</button>
        <button class="filter-pill" data-filter="CAD">CAD</button>
        <button class="filter-pill" data-filter="Manufacturing">Manufacturing</button>
        <button class="filter-pill" data-filter="Sheetmetal">Sheetmetal</button>
        <button class="filter-pill" data-filter="Surfaces">Surfaces</button>
        <button class="filter-pill" data-filter="Assembly">Assembly</button>
      </div>
    </section>

    <!-- ================= PROJECTS GRID ================= -->
    <section id="projects" class="section-projects">
      <header class="section-header">
        <p class="section-kicker">PROJECTS</p>
        <h2 class="section-title">CAD, tooling, sheetmetal &amp; mechanisms</h2>
        <p class="section-subtitle">
          Practice parts and fixtures with real machining workflows and
          interactive 3D viewers.
        </p>
      </header>

      <!-- Aquí se inyectan las cards desde JS -->
      <div id="projects-grid" class="project-grid"></div>
    </section>
  </main>

  <!-- ================= FOOTER ================= -->
  <footer class="site-footer">
    © 2025 Esteban Caicedo · Built with TailwindCSS vibes &amp; Three.js style
  </footer>

  <!-- Script de detalle de proyecto (lo usas en project.html).
       Aquí no hace falta incluirlo, así evitamos conflictos.
       Si tu página de proyecto lo usa como <script src="script.js"></script>,
       déjalo solo allí.
  -->

  <!-- Script específico para la grilla del index -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const grid = document.getElementById('projects-grid');
      if (!grid) return;

      // Filtros visuales
      const filterPills = document.querySelectorAll('.filter-pill');

      function setActiveFilter(filter) {
        filterPills.forEach(pill => {
          pill.classList.toggle('filter-pill--active', pill.dataset.filter === filter);
        });
      }

      function applyFilter(filter, cards) {
        cards.forEach(card => {
          const tags = (card.dataset.tags || '').split(',');
          if (filter === 'all' || tags.includes(filter)) {
            card.style.display = '';
          } else {
            card.style.display = 'none';
          }
        });
      }

      fetch('projects.json')
        .then(res => res.json())
        .then(projects => {
          const cards = [];

          projects.forEach(project => {
            const card = document.createElement('article');
            card.className = 'project-card';
            card.dataset.tags = (project.tags || []).join(',');

            const mediaItems =
              (project.images && project.images.length ? project.images : [])
              .concat(project.videos && project.videos.length ? project.videos : []);

            // ---------- Media / mini carrusel ----------
            let mediaHtml = '';
            if (mediaItems.length > 0) {
              mediaHtml += '<div class="project-card-media">';
              mediaHtml += '<div class="project-card-slides">';
              mediaItems.forEach((src, index) => {
                const isVideo = src.toLowerCase().endsWith('.mp4');
                mediaHtml += `
                  <div class="project-card-slide ${index === 0 ? 'is-active' : ''}">
                    ${isVideo
                      ? `<video src="${src}" muted loop playsinline></video>`
                      : `<img src="${src}" alt="${project.title} preview ${index + 1}" />`
                    }
                  </div>
                `;
              });
              mediaHtml += '</div>';

              if (mediaItems.length > 1) {
                mediaHtml += `
                  <button class="carousel-nav-button prev" type="button" aria-label="Previous image">‹</button>
                  <button class="carousel-nav-button next" type="button" aria-label="Next image">›</button>
                  <div class="carousel-dots">
                    ${mediaItems
                      .map(
                        (_, i) =>
                          `<button class="carousel-dot ${i === 0 ? 'is-active' : ''}" data-index="${i}" type="button"></button>`
                      )
                      .join('')}
                  </div>
                `;
              }

              mediaHtml += '</div>'; // .project-card-media
            } else {
              mediaHtml += `
                <div class="project-card-media project-card-media--empty">
                  <span>No preview yet</span>
                </div>
              `;
            }

            const tagsHtml = (project.tags || [])
              .map(tag => `<span class="project-tag">${tag}</span>`)
              .join('');

            card.innerHTML = `
              ${mediaHtml}
              <div class="project-card-body">
                <h3 class="project-card-title">${project.title}</h3>
                <p class="project-card-desc">${project.description}</p>
                <div class="project-card-tags">${tagsHtml}</div>
                <a class="project-card-btn" href="project.html?slug=${project.slug}">Open</a>
              </div>
            `;

            // Configuramos el mini-carrusel de esta card
            const slides = card.querySelectorAll('.project-card-slide');
            const dots = card.querySelectorAll('.carousel-dot');
            const prevBtn = card.querySelector('.carousel-nav-button.prev');
            const nextBtn = card.querySelector('.carousel-nav-button.next');

            if (slides.length > 1) {
              let current = 0;

              const goTo = (index) => {
                current = (index + slides.length) % slides.length;
                slides.forEach((slide, i) => {
                  slide.classList.toggle('is-active', i === current);
                });
                dots.forEach((dot, i) => {
                  dot.classList.toggle('is-active', i === current);
                });
              };

              if (prevBtn) {
                prevBtn.addEventListener('click', () => goTo(current - 1));
              }
              if (nextBtn) {
                nextBtn.addEventListener('click', () => goTo(current + 1));
              }
              dots.forEach(dot => {
                dot.addEventListener('click', () => {
                  const i = Number(dot.dataset.index || 0);
                  goTo(i);
                });
              });
            }

            grid.appendChild(card);
            cards.push(card);
          });

          // Listeners de filtros
          filterPills.forEach(pill => {
            pill.addEventListener('click', () => {
              const filter = pill.dataset.filter || 'all';
              setActiveFilter(filter);
              applyFilter(filter, cards);
            });
          });
        })
        .catch(err => {
          console.error('Error loading projects.json:', err);
          grid.innerHTML = '<p style="opacity:0.7">Could not load projects.</p>';
        });
    });
  </script>
</body>
</html>
