<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project – Detail</title>
  <link rel="stylesheet" href="style.css" />
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>
  <header class="topbar">
    <a class="brand" href="index.html">← Back</a>
  </header>
  <main class="container narrow" id="content">
    <h1 id="title">Loading…</h1>
    <p id="long"></p>

    <div class="detail">
      <div class="viewer">
        <model-viewer id="mv" ar autoplay camera-controls tone-mapping="neutral" exposure="1" shadow-intensity="0" style="width:100%;height:460px;background:#111;border-radius:14px;"></model-viewer>
      </div>
      <div class="gallery" id="gallery"></div>
    </div>
  </main>

  <footer class="foot">© 2025 Esteban Caicedo</footer>

  <script>
  function qs(name) { return new URLSearchParams(location.search).get(name); }

  async function load() {
    const slug = qs('slug');
    const res = await fetch('projects.json', {cache: 'no-store'});
    const projects = await res.json();
    const p = projects.find(x => x.slug === slug) || projects[0];

    document.title = p.title + ' – Project';
    document.getElementById('title').textContent = p.title;
    document.getElementById('long').textContent = p.longDescription || p.description;

    const mv = document.getElementById('mv');
    mv.setAttribute('src', p.model);

    const gal = document.getElementById('gallery');
    p.images.forEach((src, i) => {
      const img = document.createElement('img');
      img.src = src;
      img.alt = p.title + ' ' + (i+1);
      img.loading = 'lazy';
      img.className = 'thumb';
      img.onclick = () => { document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active')); img.classList.add('active'); };
      if (i === 0) img.classList.add('active');
      gal.appendChild(img);
    });
  }
  load();
  </script>
</body>
</html>
